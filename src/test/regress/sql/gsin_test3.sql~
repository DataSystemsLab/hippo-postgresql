create table gsin_tbl(orderkey int8, partkey int8, suppkey int8, linenumber int8, quantity int8, extendedprice text, discount text, tax text,returnflag text,linestatus text,shipdate text,commitdate text,receiptdate text,shipinstruct text,shipmode text,comm text);
\timing on

COPY gsin_tbl(orderkey, partkey, suppkey, linenumber, quantity, extendedprice, discount, tax,returnflag,linestatus,shipdate,commitdate,receiptdate,shipinstruct,shipmode,comm)
FROM'/home/sparkadmin/TPCH_Tools/tpch_2_17_0/dbgen/lineitem.csv'
WITH DELIMITER '|'
CSV;

Alter table gsin_tbl alter column partkey set statistics 10000;
Analyze gsin_tbl;

create index btree_idx on gsin_tbl using btree(partkey);
\di+;
--select count(*) from gsin_tbl where partkey=90000;
--select count(*) from gsin_tbl where id>20000000 and id<20000100;
--select count(*) from gsin_tbl where id>10000 and id <10010;
--select count(*) from gsin_tbl where id=10000;-->1000 and id<1010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index btree_idx;


create index brin_idx on gsin_tbl using brin(partkey) with (pages_per_range=128);
\di+;
--select count(*) from gsin_tbl where partkey=90000;--id>1000 and id<1010;
--select count(*) from gsin_tbl where id>10000 and id <10010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index brin_idx;


create index gsin_idx on gsin_tbl using gsin(partkey) with (max_pages_per_range=20);
\di+;
--select count(*) from gsin_tbl where partkey=90000;-->1000 and id<1010;
--select count(*) from gsin_tbl where id>10000 and id <10010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index gsin_idx;


create index btree_idx on gsin_tbl using btree(partkey);
--\di+;
--select count(*) from gsin_tbl where partkey=90000;
--select count(*) from gsin_tbl where id>20000000 and id<20000100;
--select count(*) from gsin_tbl where id>10000 and id <10010;
--select count(*) from gsin_tbl where id=10000;-->1000 and id<1010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index btree_idx;


create index brin_idx on gsin_tbl using brin(partkey) with (pages_per_range=128);
--\di+;
--select count(*) from gsin_tbl where partkey=90000;--id>1000 and id<1010;
--select count(*) from gsin_tbl where id>10000 and id <10010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index brin_idx;


create index gsin_idx on gsin_tbl using gsin(partkey) with (max_pages_per_range=20);
--\di+;
--select count(*) from gsin_tbl where partkey=90000;-->1000 and id<1010;
--select count(*) from gsin_tbl where id>10000 and id <10010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index gsin_idx;


create index btree_idx on gsin_tbl using btree(partkey);
--\di+;
--select count(*) from gsin_tbl where partkey=90000;
--select count(*) from gsin_tbl where id>20000000 and id<20000100;
--select count(*) from gsin_tbl where id>10000 and id <10010;
--select count(*) from gsin_tbl where id=10000;-->1000 and id<1010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index btree_idx;


create index brin_idx on gsin_tbl using brin(partkey) with (pages_per_range=128);
--\di+;
--select count(*) from gsin_tbl where partkey=90000;--id>1000 and id<1010;
--select count(*) from gsin_tbl where id>10000 and id <10010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index brin_idx;


create index gsin_idx on gsin_tbl using gsin(partkey) with (max_pages_per_range=20);
--\di+;
--select count(*) from gsin_tbl where partkey=90000;-->1000 and id<1010;
--select count(*) from gsin_tbl where id>10000 and id <10010;
select count(*) from gsin_tbl where partkey>10000 and partkey<10020;
select count(*) from gsin_tbl where partkey>10000 and partkey<10200;
select count(*) from gsin_tbl where partkey>10000 and partkey<12000;
drop index gsin_idx;



drop table gsin_tbl;
